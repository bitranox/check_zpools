src/check_zpools/logging_setup.py
    F 75:0 init_logging - A (2)
    F 34:0 _build_runtime_config - A (1)
src/check_zpools/zfs_client.py
    M 302:4 ZFSClient._execute_command - A (4)
    C 87:0 ZFSClient - A (3)
    M 109:4 ZFSClient.__init__ - A (3)
    M 157:4 ZFSClient.get_pool_list - A (3)
    C 41:0 ZFSCommandError - A (2)
    M 138:4 ZFSClient.check_zpool_available - A (2)
    M 210:4 ZFSClient.get_pool_status - A (2)
    M 257:4 ZFSClient.get_pool_status_text - A (2)
    M 379:4 ZFSClient._execute_json_command - A (2)
    M 58:4 ZFSCommandError.__init__ - A (1)
    C 76:0 ZFSNotAvailableError - A (1)
    M 426:4 ZFSClient._execute_text_command - A (1)
src/check_zpools/formatters.py
    F 225:0 _format_last_scrub - B (8)
    F 127:0 _format_pool_row - B (6)
    F 27:0 format_check_result_json - A (3)
    F 65:0 format_check_result_text - A (3)
    F 169:0 _display_issues - A (3)
    F 188:0 display_check_result_text - A (3)
    F 279:0 _get_severity_color - A (3)
    F 300:0 get_exit_code_for_severity - A (3)
    F 109:0 _build_pool_status_table - A (1)
src/check_zpools/monitor.py
    M 327:4 PoolMonitor._check_errors - B (7)
    M 392:4 PoolMonitor._check_scrub - B (6)
    C 39:0 MonitorConfig - A (5)
    C 88:0 PoolMonitor - A (5)
    M 79:4 MonitorConfig.__post_init__ - A (4)
    M 127:4 PoolMonitor.check_pool - A (4)
    M 188:4 PoolMonitor.check_all_pools - A (4)
    M 249:4 PoolMonitor._check_health - A (3)
    M 282:4 PoolMonitor._check_capacity - A (3)
    M 109:4 PoolMonitor.__init__ - A (1)
src/check_zpools/__main__.py
    F 48:0 _open_cli_session - A (1)
    F 68:0 _command_to_run - A (1)
    F 82:0 _command_name - A (1)
    F 96:0 _module_main - A (1)
src/check_zpools/models.py
    C 232:0 PoolStatus - A (4)
    M 303:4 PoolStatus.has_errors - A (3)
    C 380:0 CheckResult - A (3)
    M 440:4 CheckResult.critical_issues - A (3)
    M 460:4 CheckResult.warning_issues - A (3)
    C 44:0 PoolHealth - A (2)
    C 124:0 Severity - A (2)
    M 168:4 Severity.__lt__ - A (2)
    M 185:4 Severity.__le__ - A (2)
    M 191:4 Severity.__gt__ - A (2)
    M 197:4 Severity.__ge__ - A (2)
    C 324:0 PoolIssue - A (2)
    M 78:4 PoolHealth.is_healthy - A (1)
    M 101:4 PoolHealth.is_critical - A (1)
    M 151:4 Severity._order_value - A (1)
    M 204:4 Severity.is_critical - A (1)
    M 363:4 PoolIssue.__str__ - A (1)
    M 424:4 CheckResult.has_issues - A (1)
src/check_zpools/cli.py
    F 681:0 cli_send_email - B (7)
    F 527:0 cli_config_deploy - A (5)
    F 784:0 cli_send_notification - A (5)
    F 1024:0 cli_check - A (5)
    F 877:0 cli_install_service - A (4)
    F 393:0 cli - A (3)
    F 950:0 cli_uninstall_service - A (3)
    F 1071:0 cli_daemon - A (3)
    F 213:0 _invoke_cli - A (2)
    F 253:0 _traceback_limit - A (2)
    F 334:0 _run_cli_via_exit_tools - A (2)
    F 1099:0 _load_and_validate_email_config - A (2)
    F 1135:0 _restore_when_requested - A (2)
    F 79:0 apply_traceback_preferences - A (1)
    F 107:0 snapshot_traceback_state - A (1)
    F 128:0 restore_traceback_state - A (1)
    F 149:0 _record_traceback_choice - A (1)
    F 175:0 _announce_traceback_choice - A (1)
    F 194:0 _no_subcommand_requested - A (1)
    F 237:0 _current_traceback_mode - A (1)
    F 276:0 _print_exception - A (1)
    F 307:0 _traceback_option_requested - A (1)
    F 328:0 _show_help - A (1)
    F 435:0 cli_main - A (1)
    F 455:0 cli_info - A (1)
    F 464:0 cli_hello - A (1)
    F 473:0 cli_fail - A (1)
    F 494:0 cli_config - A (1)
    F 579:0 main - A (1)
    F 625:0 _handle_send_email_error - A (1)
    F 995:0 cli_service_status - A (1)
src/check_zpools/alerting.py
    M 628:4 EmailAlerter._format_notes_section - B (8)
    M 384:4 EmailAlerter._format_recommended_actions_section - A (5)
    M 558:4 EmailAlerter._format_scrub_status_section - A (5)
    M 156:4 EmailAlerter.send_recovery - A (4)
    C 48:0 EmailAlerter - A (3)
    M 95:4 EmailAlerter.send_alert - A (3)
    M 303:4 EmailAlerter._format_alert_header - A (3)
    M 345:4 EmailAlerter._format_pool_details_section - A (3)
    M 602:4 EmailAlerter._format_health_assessment_section - A (3)
    M 689:4 EmailAlerter._append_zpool_status - A (3)
    M 456:4 EmailAlerter._format_complete_pool_status - A (2)
    M 533:4 EmailAlerter._format_error_statistics_section - A (2)
    M 672:4 EmailAlerter._calculate_scrub_age_days - A (2)
    M 735:4 EmailAlerter._format_recovery_body - A (2)
    M 76:4 EmailAlerter.__init__ - A (1)
    M 222:4 EmailAlerter._format_subject - A (1)
    M 242:4 EmailAlerter._format_recovery_subject - A (1)
    M 260:4 EmailAlerter._format_body - A (1)
    M 436:4 EmailAlerter._format_alert_footer - A (1)
    M 503:4 EmailAlerter._format_capacity_section - A (1)
src/check_zpools/config_deploy.py
    F 31:0 deploy_configuration - A (1)
src/check_zpools/config.py
    F 34:0 get_default_config_path - A (1)
    F 67:0 get_config - A (1)
src/check_zpools/behaviors.py
    F 380:0 _build_monitor_config - B (8)
    F 163:0 check_pools_once - A (4)
    F 441:0 _get_state_file_path - A (4)
    F 323:0 run_daemon - A (3)
    F 55:0 _target_stream - A (2)
    F 67:0 _flush_if_possible - A (2)
    F 244:0 _load_config_with_logging - A (2)
    F 283:0 _initialize_daemon_components - A (2)
    F 61:0 _greeting_line - A (1)
    F 75:0 emit_greeting - A (1)
    F 112:0 raise_intentional_failure - A (1)
    F 140:0 noop_main - A (1)
src/check_zpools/zfs_parser.py
    M 433:4 ZFSParser._extract_error_counts - B (7)
    M 86:4 ZFSParser.parse_pool_list - A (5)
    M 142:4 ZFSParser.parse_pool_status - A (5)
    M 191:4 ZFSParser.merge_pool_data - A (5)
    M 483:4 ZFSParser._try_parse_unix_timestamp - A (5)
    M 510:4 ZFSParser._try_parse_datetime_string - A (5)
    C 55:0 ZFSParser - A (4)
    M 361:4 ZFSParser._parse_size_to_bytes - A (4)
    M 555:4 ZFSParser._parse_scrub_time - A (4)
    M 336:4 ZFSParser._get_property_value - A (2)
    M 538:4 ZFSParser._normalize_timezone - A (2)
    M 593:4 ZFSParser._parse_health_state - A (2)
    M 614:4 ZFSParser._extract_capacity_metrics - A (2)
    M 655:4 ZFSParser._extract_scrub_info - A (2)
    C 44:0 ZFSParseError - A (1)
    M 255:4 ZFSParser._parse_pool_from_list - A (1)
    M 295:4 ZFSParser._parse_pool_from_status - A (1)
src/check_zpools/alert_state.py
    M 259:4 AlertStateManager.load_state - B (8)
    C 64:0 AlertStateManager - A (4)
    M 105:4 AlertStateManager.should_alert - A (4)
    M 326:4 AlertStateManager.save_state - A (4)
    M 93:4 AlertStateManager._ensure_state_dir - A (2)
    M 174:4 AlertStateManager.record_alert - A (2)
    M 224:4 AlertStateManager.clear_issue - A (2)
    C 40:0 AlertState - A (1)
    M 86:4 AlertStateManager.__init__ - A (1)
    M 101:4 AlertStateManager._make_key - A (1)
src/check_zpools/cli_errors.py
    F 27:0 handle_zfs_not_available - A (1)
    F 56:0 handle_generic_error - A (1)
src/check_zpools/__init__conf__.py
    F 45:0 print_info - A (3)
src/check_zpools/config_show.py
    F 91:0 _display_value_with_source - B (7)
    F 30:0 _collect_dotted_keys - A (4)
    F 189:0 _display_human_section - A (4)
    F 62:0 _format_source_info - A (3)
    F 141:0 _display_json_section - A (3)
    F 167:0 _display_human_section_data - A (3)
    F 218:0 display_config - A (2)
src/check_zpools/service_install.py
    F 131:0 _detect_uvx_from_process_tree - B (9)
    F 401:0 install_service - B (8)
    F 506:0 uninstall_service - B (6)
    F 198:0 _find_executable - A (5)
    F 47:0 _check_root_privileges - A (4)
    F 69:0 _is_uvx_process - A (4)
    F 107:0 _extract_version_from_cmdline - A (4)
    F 629:0 show_service_status - A (4)
    F 247:0 _create_service_directories - A (3)
    F 266:0 _generate_service_file_content - A (3)
    F 87:0 _find_uvx_executable - A (2)
    F 584:0 get_service_status - A (2)
    F 350:0 _install_service_file - A (1)
    F 375:0 _run_systemctl - A (1)
src/check_zpools/daemon.py
    M 102:4 ZPoolDaemon.start - B (8)
    M 575:4 ZPoolDaemon._detect_recoveries - B (8)
    M 372:4 ZPoolDaemon._handle_check_result - A (5)
    M 491:4 ZPoolDaemon._format_uptime - A (5)
    C 43:0 ZPoolDaemon - A (4)
    M 284:4 ZPoolDaemon._filter_monitored_pools - A (4)
    M 428:4 ZPoolDaemon._should_send_alert - A (4)
    M 225:4 ZPoolDaemon._run_monitoring_loop - A (3)
    M 251:4 ZPoolDaemon._fetch_and_parse_pools - A (3)
    M 330:4 ZPoolDaemon._run_check_cycle - A (3)
    M 519:4 ZPoolDaemon._format_bytes - A (3)
    M 542:4 ZPoolDaemon._log_pool_details - A (3)
    M 161:4 ZPoolDaemon.stop - A (2)
    M 464:4 ZPoolDaemon._send_alert_for_issue - A (2)
    M 71:4 ZPoolDaemon.__init__ - A (1)
    M 182:4 ZPoolDaemon._setup_signal_handlers - A (1)
    M 304:4 ZPoolDaemon._log_cycle_completion - A (1)
src/check_zpools/mail.py
    M 88:4 EmailConfig.__post_init__ - B (9)
    F 169:0 send_email - B (7)
    C 41:0 EmailConfig - B (6)
    F 162:0 _resolve_credentials - A (3)
    F 436:0 load_email_config_from_dict - A (3)
    F 354:0 _get_string_value - A (2)
    F 375:0 _get_optional_string - A (2)
    F 394:0 _get_bool_value - A (2)
    F 415:0 _get_float_value - A (2)
    F 35:0 _default_smtp_hosts - A (1)
    F 290:0 send_notification - A (1)
    M 133:4 EmailConfig.to_conf_mail - A (1)

201 blocks (classes, functions, methods) analyzed.
Average complexity: A (2.8208955223880596)
