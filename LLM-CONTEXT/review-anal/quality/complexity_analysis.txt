================================================================================
COMPLEXITY ANALYSIS REPORT
================================================================================


File: scripts/test.py
--------------------------------------------------------------------------------
Total Lines: 536
Code Lines: 448
Functions: 21
Classes: 0
Avg Complexity: 5.62
Max Complexity: 17

Functions:
  _run (line 119):
    Lines: 37
    Cyclomatic Complexity: 17
    Cognitive Complexity: 20
    Parameters: 5
    Returns: 1
    Nesting Depth: 3
  _upload_coverage_report (line 372):
    Lines: 60
    Cyclomatic Complexity: 13
    Cognitive Complexity: 10
    Parameters: 1
    Returns: 6
    Nesting Depth: 1
  _pip_audit_guarded (line 163):
    Lines: 51
    Cyclomatic Complexity: 12
    Cognitive Complexity: 17
    Parameters: 0
    Returns: 1
    Nesting Depth: 3
  run_tests (line 112):
    Lines: 238
    Cyclomatic Complexity: 12
    Cognitive Complexity: 16
    Parameters: 3
    Returns: 3
    Nesting Depth: 2
  run_coverage (line 52):
    Lines: 32
    Cyclomatic Complexity: 10
    Cognitive Complexity: 11
    Parameters: 1
    Returns: 0
    Nesting Depth: 2
  _run_pytest (line 291):
    Lines: 39
    Cyclomatic Complexity: 9
    Cognitive Complexity: 6
    Parameters: 0
    Returns: 0
    Nesting Depth: 2
  _ensure_codecov_token (line 478):
    Lines: 20
    Cyclomatic Complexity: 9
    Cognitive Complexity: 12
    Parameters: 0
    Returns: 2
    Nesting Depth: 3
  _prune_coverage_data_files (line 500):
    Lines: 13
    Cyclomatic Complexity: 6
    Cognitive Complexity: 7
    Parameters: 0
    Returns: 0
    Nesting Depth: 2
  _resolve_pip_audit_ignores (line 86):
    Lines: 9
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 0
    Returns: 1
    Nesting Depth: 2
  _resolve_commit_sha (line 434):
    Lines: 14
    Cyclomatic Complexity: 4
    Cognitive Complexity: 2
    Parameters: 0
    Returns: 3
    Nesting Depth: 1
  _resolve_git_branch (line 450):
    Lines: 16
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 0
    Returns: 4
    Nesting Depth: 1
  _remove_report_artifacts (line 515):
    Lines: 11
    Cyclomatic Complexity: 4
    Cognitive Complexity: 5
    Parameters: 0
    Returns: 0
    Nesting Depth: 1
  _extract_audit_dependencies (line 97):
    Lines: 13
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 3
    Nesting Depth: 1
  _get_toml_module (line 352):
    Lines: 9
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 2
    Nesting Depth: 1
  _read_fail_under (line 363):
    Lines: 7
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 0
  _resolve_git_service (line 468):
    Lines: 8
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  _build_default_env (line 37):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  _refresh_default_env (line 46):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  _runner (line 158):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  _wrap (line 157):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  main (line 528):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0

File: scripts/_utils.py
--------------------------------------------------------------------------------
Total Lines: 782
Code Lines: 600
Functions: 44
Classes: 2
Avg Complexity: 2.95
Max Complexity: 14

Functions:
  bootstrap_dev (line 737):
    Lines: 45
    Cyclomatic Complexity: 14
    Cognitive Complexity: 17
    Parameters: 0
    Returns: 0
    Nesting Depth: 3
  run (line 144):
    Lines: 31
    Cyclomatic Complexity: 8
    Cognitive Complexity: 3
    Parameters: 6
    Returns: 2
    Nesting Depth: 1
  _parse_authors_list (line 427):
    Lines: 28
    Cyclomatic Complexity: 8
    Cognitive Complexity: 10
    Parameters: 1
    Returns: 2
    Nesting Depth: 2
  _derive_import_package (line 249):
    Lines: 17
    Cyclomatic Complexity: 7
    Cognitive Complexity: 6
    Parameters: 2
    Returns: 3
    Nesting Depth: 2
  _select_cli_entry (line 302):
    Lines: 24
    Cyclomatic Complexity: 6
    Cognitive Complexity: 7
    Parameters: 2
    Returns: 3
    Nesting Depth: 2
  _as_str_dict (line 211):
    Lines: 10
    Cyclomatic Complexity: 5
    Cognitive Complexity: 6
    Parameters: 1
    Returns: 1
    Nesting Depth: 3
  github_tarball_url (line 66):
    Lines: 4
    Cyclomatic Complexity: 4
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  _as_str_mapping (line 199):
    Lines: 10
    Cyclomatic Complexity: 4
    Cognitive Complexity: 6
    Parameters: 1
    Returns: 1
    Nesting Depth: 3
  _derive_coverage_source (line 268):
    Lines: 9
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 2
    Nesting Depth: 2
  _derive_scripts (line 279):
    Lines: 10
    Cyclomatic Complexity: 4
    Cognitive Complexity: 6
    Parameters: 1
    Returns: 1
    Nesting Depth: 3
  _parse_repository_url (line 354):
    Lines: 21
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 3
    Nesting Depth: 1
  diagnostic_lines (line 89):
    Lines: 14
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  _get_toml_module (line 110):
    Lines: 32
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 0
    Returns: 2
    Nesting Depth: 1
  _load_pyproject (line 232):
    Lines: 15
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  _extract_project_name (line 328):
    Lines: 14
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _derive_summary (line 393):
    Lines: 20
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 3
    Returns: 3
    Nesting Depth: 1
  _extract_author_field (line 415):
    Lines: 10
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  _extract_author_info (line 457):
    Lines: 17
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 1
    Nesting Depth: 1
  _render_metadata_module (line 580):
    Lines: 78
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  sync_metadata_module (line 660):
    Lines: 13
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  read_version_from_pyproject (line 675):
    Lines: 9
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  resolve_cli_entry (line 71):
    Lines: 17
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  _normalize_slug (line 181):
    Lines: 3
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _as_sequence (line 223):
    Lines: 7
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  _parse_entrypoint (line 295):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _extract_urls (line 377):
    Lines: 14
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _determine_shell_command (line 476):
    Lines: 20
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 4
    Returns: 1
    Nesting Depth: 1
  get_project_metadata (line 507):
    Lines: 67
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  ensure_clean_git_tree (line 686):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 0
    Nesting Depth: 1
  git_delete_tag (line 697):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  cmd_exists (line 177):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _package_name_to_display (line 186):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _normalize_script_key (line 291):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _extract_description (line 344):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _build_metadata_module_path (line 498):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _quote (line 576):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  git_branch (line 693):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  git_tag_exists (line 703):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  git_create_annotated_tag (line 713):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  git_push (line 717):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  gh_available (line 721):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  gh_release_exists (line 725):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  gh_release_create (line 729):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  gh_release_edit (line 733):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0

File: scripts/menu.py
--------------------------------------------------------------------------------
Total Lines: 569
Code Lines: 486
Functions: 40
Classes: 4
Avg Complexity: 2.70
Max Complexity: 11

Functions:
  _gather_values (line 337):
    Lines: 21
    Cyclomatic Complexity: 11
    Cognitive Complexity: 12
    Parameters: 1
    Returns: 2
    Nesting Depth: 3
  on_key (line 137):
    Lines: 22
    Cyclomatic Complexity: 8
    Cognitive Complexity: 10
    Parameters: 2
    Returns: 3
    Nesting Depth: 3
  compose (line 275):
    Lines: 28
    Cyclomatic Complexity: 8
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 0
    Nesting Depth: 2
  compose (line 382):
    Lines: 12
    Cyclomatic Complexity: 5
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  compose (line 89):
    Lines: 22
    Cyclomatic Complexity: 4
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  on_button_pressed (line 172):
    Lines: 7
    Cyclomatic Complexity: 4
    Cognitive Complexity: 6
    Parameters: 2
    Returns: 0
    Nesting Depth: 3
  _receive_params (line 229):
    Lines: 12
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  on_list_view_highlighted (line 119):
    Lines: 8
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  on_list_view_selected (line 128):
    Lines: 8
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  action_run (line 180):
    Lines: 9
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  action_edit (line 190):
    Lines: 6
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  _current_target (line 215):
    Lines: 7
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 3
    Nesting Depth: 1
  _handle_run_result (line 245):
    Lines: 9
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  on_input_submitted (line 311):
    Lines: 3
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  _submit (line 327):
    Lines: 9
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 1
    Nesting Depth: 2
  action_cancel (line 410):
    Lines: 5
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  _send_cancel_signal (line 455):
    Lines: 11
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  on_mount (line 112):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _focus_menu (line 160):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _focus_button (line 166):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _build_list (line 197):
    Lines: 9
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  _update_description (line 207):
    Lines: 7
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  on_button_pressed (line 307):
    Lines: 3
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  _focus_first_input (line 318):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  _focus_ok_button (line 323):
    Lines: 3
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  on_button_pressed (line 406):
    Lines: 3
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  _format_env (line 546):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  _format_command (line 553):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  __init__ (line 80):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  _open_param_editor (line 223):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  _launch_run (line 242):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  menu_app (line 256):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  __init__ (line 267):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  on_mount (line 304):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  action_cancel (line 315):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  menu_app (line 360):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  __init__ (line 371):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  __init__ (line 538):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  on_mount (line 542):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  run_menu (line 561):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0

File: scripts/push.py
--------------------------------------------------------------------------------
Total Lines: 78
Code Lines: 59
Functions: 2
Classes: 0
Avg Complexity: 7.00
Max Complexity: 11

Functions:
  _resolve_commit_message (line 45):
    Lines: 27
    Cyclomatic Complexity: 11
    Cognitive Complexity: 5
    Parameters: 1
    Returns: 5
    Nesting Depth: 1
  push (line 20):
    Lines: 23
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1

File: src/check_zpools/mail.py
--------------------------------------------------------------------------------
Total Lines: 496
Code Lines: 412
Functions: 11
Classes: 1
Avg Complexity: 2.00
Max Complexity: 9

Functions:
  __post_init__ (line 88):
    Lines: 44
    Cyclomatic Complexity: 9
    Cognitive Complexity: 17
    Parameters: 1
    Returns: 0
    Nesting Depth: 3
  _resolve_credentials (line 162):
    Lines: 5
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  send_email (line 169):
    Lines: 119
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 7
    Returns: 1
    Nesting Depth: 0
  _default_smtp_hosts (line 35):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  to_conf_mail (line 133):
    Lines: 27
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  send_notification (line 290):
    Lines: 62
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 1
    Nesting Depth: 0
  _get_string_value (line 354):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  _get_optional_string (line 375):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  _get_bool_value (line 394):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  _get_float_value (line 415):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  load_email_config_from_dict (line 436):
    Lines: 52
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/service_install.py
--------------------------------------------------------------------------------
Total Lines: 662
Code Lines: 484
Functions: 14
Classes: 0
Avg Complexity: 3.79
Max Complexity: 9

Functions:
  _detect_uvx_from_process_tree (line 131):
    Lines: 65
    Cyclomatic Complexity: 9
    Cognitive Complexity: 13
    Parameters: 0
    Returns: 2
    Nesting Depth: 3
  install_service (line 401):
    Lines: 103
    Cyclomatic Complexity: 8
    Cognitive Complexity: 9
    Parameters: 3
    Returns: 0
    Nesting Depth: 2
  uninstall_service (line 506):
    Lines: 76
    Cyclomatic Complexity: 6
    Cognitive Complexity: 7
    Parameters: 2
    Returns: 1
    Nesting Depth: 2
  _find_executable (line 198):
    Lines: 47
    Cyclomatic Complexity: 5
    Cognitive Complexity: 3
    Parameters: 0
    Returns: 4
    Nesting Depth: 1
  _check_root_privileges (line 47):
    Lines: 20
    Cyclomatic Complexity: 4
    Cognitive Complexity: 2
    Parameters: 0
    Returns: 0
    Nesting Depth: 1
  _is_uvx_process (line 69):
    Lines: 16
    Cyclomatic Complexity: 4
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  _extract_version_from_cmdline (line 107):
    Lines: 22
    Cyclomatic Complexity: 4
    Cognitive Complexity: 6
    Parameters: 1
    Returns: 2
    Nesting Depth: 3
  _create_service_directories (line 247):
    Lines: 17
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 0
    Returns: 0
    Nesting Depth: 2
  _find_uvx_executable (line 87):
    Lines: 18
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  _generate_service_file_content (line 266):
    Lines: 82
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 1
    Nesting Depth: 1
  get_service_status (line 584):
    Lines: 43
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 2
    Nesting Depth: 1
  show_service_status (line 629):
    Lines: 25
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 0
    Nesting Depth: 1
  _install_service_file (line 350):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  _run_systemctl (line 375):
    Lines: 24
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0

File: tests/conftest.py
--------------------------------------------------------------------------------
Total Lines: 499
Code Lines: 365
Functions: 21
Classes: 0
Avg Complexity: 1.57
Max Complexity: 9

Functions:
  pytest_runtest_setup (line 92):
    Lines: 24
    Cyclomatic Complexity: 9
    Cognitive Complexity: 4
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _load_dotenv (line 36):
    Lines: 11
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 0
    Returns: 0
    Nesting Depth: 1
  _restore_cli_config (line 150):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  a_pool_for_alerting (line 277):
    Lines: 41
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 4
    Returns: 1
    Nesting Depth: 1
  pytest_configure (line 60):
    Lines: 30
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  _remove_ansi_codes (line 118):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _snapshot_cli_config (line 136):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  cli_runner (line 166):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  _strip (line 176):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  strip_ansi (line 173):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 2
    Nesting Depth: 0
  preserve_traceback_state (line 183):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  isolated_traceback_config (line 194):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  a_healthy_pool_named (line 207):
    Lines: 31
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  a_pool_with (line 240):
    Lines: 35
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  an_issue_for_pool (line 325):
    Lines: 29
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 1
    Nesting Depth: 0
  a_capacity_issue (line 356):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  an_error_issue (line 380):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  a_scrub_issue (line 403):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  a_health_issue (line 426):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  sample_pool (line 455):
    Lines: 24
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  sample_issue (line 482):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/alert_state.py
--------------------------------------------------------------------------------
Total Lines: 373
Code Lines: 299
Functions: 8
Classes: 2
Avg Complexity: 3.00
Max Complexity: 8

Functions:
  load_state (line 259):
    Lines: 66
    Cyclomatic Complexity: 8
    Cognitive Complexity: 7
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  should_alert (line 105):
    Lines: 68
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 3
    Nesting Depth: 1
  save_state (line 326):
    Lines: 47
    Cyclomatic Complexity: 4
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _ensure_state_dir (line 93):
    Lines: 7
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  record_alert (line 174):
    Lines: 49
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  clear_issue (line 224):
    Lines: 34
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 2
    Nesting Depth: 1
  __init__ (line 86):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  _make_key (line 101):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/alerting.py
--------------------------------------------------------------------------------
Total Lines: 788
Code Lines: 654
Functions: 19
Classes: 1
Avg Complexity: 2.53
Max Complexity: 8

Functions:
  _format_notes_section (line 628):
    Lines: 43
    Cyclomatic Complexity: 8
    Cognitive Complexity: 10
    Parameters: 2
    Returns: 2
    Nesting Depth: 2
  _format_recommended_actions_section (line 384):
    Lines: 51
    Cyclomatic Complexity: 5
    Cognitive Complexity: 10
    Parameters: 3
    Returns: 1
    Nesting Depth: 4
  send_recovery (line 156):
    Lines: 65
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 4
    Returns: 4
    Nesting Depth: 1
  send_alert (line 95):
    Lines: 60
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 3
    Returns: 3
    Nesting Depth: 1
  _format_alert_header (line 303):
    Lines: 41
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 5
    Returns: 1
    Nesting Depth: 2
  _format_pool_details_section (line 345):
    Lines: 38
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _format_scrub_status_section (line 558):
    Lines: 43
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _format_health_assessment_section (line 602):
    Lines: 25
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 1
    Nesting Depth: 2
  _append_zpool_status (line 689):
    Lines: 44
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 4
    Returns: 1
    Nesting Depth: 1
  _format_complete_pool_status (line 456):
    Lines: 46
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _calculate_scrub_age_days (line 672):
    Lines: 16
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  _format_recovery_body (line 735):
    Lines: 53
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 4
    Returns: 1
    Nesting Depth: 1
  __init__ (line 76):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 7
    Returns: 0
    Nesting Depth: 0
  _format_subject (line 222):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 1
    Nesting Depth: 0
  _format_recovery_subject (line 242):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  _format_body (line 260):
    Lines: 42
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  _format_alert_footer (line 436):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  _format_capacity_section (line 503):
    Lines: 29
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  _format_error_statistics_section (line 533):
    Lines: 24
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/behaviors.py
--------------------------------------------------------------------------------
Total Lines: 453
Code Lines: 341
Functions: 10
Classes: 0
Avg Complexity: 2.80
Max Complexity: 8

Functions:
  _build_monitor_config (line 354):
    Lines: 59
    Cyclomatic Complexity: 8
    Cognitive Complexity: 7
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  run_daemon (line 244):
    Lines: 108
    Cyclomatic Complexity: 5
    Cognitive Complexity: 4
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  check_pools_once (line 163):
    Lines: 79
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  _get_state_file_path (line 415):
    Lines: 28
    Cyclomatic Complexity: 4
    Cognitive Complexity: 4
    Parameters: 1
    Returns: 2
    Nesting Depth: 2
  _flush_if_possible (line 67):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _target_stream (line 55):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _greeting_line (line 61):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  emit_greeting (line 75):
    Lines: 35
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  raise_intentional_failure (line 112):
    Lines: 26
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  noop_main (line 140):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/formatters.py
--------------------------------------------------------------------------------
Total Lines: 342
Code Lines: 263
Functions: 9
Classes: 0
Avg Complexity: 3.00
Max Complexity: 8

Functions:
  _format_last_scrub (line 226):
    Lines: 52
    Cyclomatic Complexity: 8
    Cognitive Complexity: 17
    Parameters: 1
    Returns: 2
    Nesting Depth: 5
  format_check_result_text (line 66):
    Lines: 42
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 1
    Nesting Depth: 2
  _display_issues (line 170):
    Lines: 17
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 0
    Nesting Depth: 2
  display_check_result_text (line 189):
    Lines: 35
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  _get_severity_color (line 281):
    Lines: 25
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 3
    Nesting Depth: 2
  get_exit_code_for_severity (line 309):
    Lines: 25
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 3
    Nesting Depth: 2
  _format_pool_row (line 128):
    Lines: 40
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  format_check_result_json (line 28):
    Lines: 36
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _build_pool_status_table (line 110):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/cli.py
--------------------------------------------------------------------------------
Total Lines: 1157
Code Lines: 912
Functions: 30
Classes: 0
Avg Complexity: 2.37
Max Complexity: 7

Functions:
  cli_send_email (line 661):
    Lines: 103
    Cyclomatic Complexity: 7
    Cognitive Complexity: 5
    Parameters: 6
    Returns: 0
    Nesting Depth: 1
  cli_config_deploy (line 527):
    Lines: 50
    Cyclomatic Complexity: 6
    Cognitive Complexity: 5
    Parameters: 2
    Returns: 0
    Nesting Depth: 2
  cli_send_notification (line 784):
    Lines: 72
    Cyclomatic Complexity: 6
    Cognitive Complexity: 4
    Parameters: 3
    Returns: 0
    Nesting Depth: 1
  cli_check (line 1024):
    Lines: 38
    Cyclomatic Complexity: 6
    Cognitive Complexity: 4
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  cli_install_service (line 877):
    Lines: 58
    Cyclomatic Complexity: 5
    Cognitive Complexity: 3
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  cli_uninstall_service (line 950):
    Lines: 42
    Cyclomatic Complexity: 4
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  cli_daemon (line 1071):
    Lines: 26
    Cyclomatic Complexity: 4
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  cli (line 393):
    Lines: 40
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 0
    Nesting Depth: 2
  _run_cli_via_exit_tools (line 334):
    Lines: 40
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 2
    Nesting Depth: 0
  cli_info (line 455):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  cli_hello (line 464):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  cli_fail (line 473):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  cli_config (line 494):
    Lines: 16
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  cli_service_status (line 995):
    Lines: 20
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  _load_and_validate_email_config (line 1099):
    Lines: 34
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 1
    Nesting Depth: 1
  _restore_when_requested (line 1135):
    Lines: 22
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  apply_traceback_preferences (line 79):
    Lines: 26
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  snapshot_traceback_state (line 107):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  restore_traceback_state (line 128):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  _record_traceback_choice (line 149):
    Lines: 24
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  _announce_traceback_choice (line 175):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  _no_subcommand_requested (line 194):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _invoke_cli (line 213):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _current_traceback_mode (line 237):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  _traceback_limit (line 253):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  _print_exception (line 276):
    Lines: 29
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  _traceback_option_requested (line 307):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _show_help (line 328):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  cli_main (line 435):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  main (line 579):
    Lines: 44
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/config_show.py
--------------------------------------------------------------------------------
Total Lines: 279
Code Lines: 229
Functions: 7
Classes: 0
Avg Complexity: 3.57
Max Complexity: 7

Functions:
  _display_value_with_source (line 91):
    Lines: 48
    Cyclomatic Complexity: 7
    Cognitive Complexity: 11
    Parameters: 5
    Returns: 0
    Nesting Depth: 3
  _display_human_section (line 189):
    Lines: 27
    Cyclomatic Complexity: 4
    Cognitive Complexity: 5
    Parameters: 2
    Returns: 0
    Nesting Depth: 2
  _collect_dotted_keys (line 30):
    Lines: 30
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 1
    Nesting Depth: 2
  _format_source_info (line 62):
    Lines: 27
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 3
    Nesting Depth: 1
  _display_json_section (line 141):
    Lines: 24
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 0
    Nesting Depth: 2
  _display_human_section_data (line 167):
    Lines: 20
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 3
    Returns: 0
    Nesting Depth: 2
  display_config (line 218):
    Lines: 56
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1

File: src/check_zpools/daemon.py
--------------------------------------------------------------------------------
Total Lines: 608
Code Lines: 482
Functions: 17
Classes: 1
Avg Complexity: 3.06
Max Complexity: 7

Functions:
  _detect_recoveries (line 556):
    Lines: 52
    Cyclomatic Complexity: 7
    Cognitive Complexity: 10
    Parameters: 2
    Returns: 1
    Nesting Depth: 3
  start (line 102):
    Lines: 58
    Cyclomatic Complexity: 6
    Cognitive Complexity: 4
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _handle_check_result (line 353):
    Lines: 55
    Cyclomatic Complexity: 5
    Cognitive Complexity: 7
    Parameters: 3
    Returns: 1
    Nesting Depth: 2
  _format_uptime (line 472):
    Lines: 27
    Cyclomatic Complexity: 5
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _should_send_alert (line 409):
    Lines: 35
    Cyclomatic Complexity: 4
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 3
    Nesting Depth: 1
  _run_monitoring_loop (line 206):
    Lines: 25
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _fetch_and_parse_pools (line 232):
    Lines: 32
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 3
    Nesting Depth: 0
  _run_check_cycle (line 311):
    Lines: 41
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  _format_bytes (line 500):
    Lines: 22
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _log_pool_details (line 523):
    Lines: 32
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 0
    Nesting Depth: 2
  stop (line 161):
    Lines: 20
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  _filter_monitored_pools (line 265):
    Lines: 19
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  _send_alert_for_issue (line 445):
    Lines: 26
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 0
    Nesting Depth: 1
  __init__ (line 71):
    Lines: 30
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 6
    Returns: 0
    Nesting Depth: 0
  signal_handler (line 196):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  _setup_signal_handlers (line 182):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  _log_cycle_completion (line 285):
    Lines: 25
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0

File: src/check_zpools/monitor.py
--------------------------------------------------------------------------------
Total Lines: 454
Code Lines: 366
Functions: 8
Classes: 2
Avg Complexity: 3.75
Max Complexity: 7

Functions:
  _check_errors (line 327):
    Lines: 64
    Cyclomatic Complexity: 7
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _check_scrub (line 392):
    Lines: 56
    Cyclomatic Complexity: 5
    Cognitive Complexity: 6
    Parameters: 2
    Returns: 4
    Nesting Depth: 2
  __post_init__ (line 79):
    Lines: 7
    Cyclomatic Complexity: 4
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  check_pool (line 127):
    Lines: 60
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  check_all_pools (line 188):
    Lines: 60
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _check_health (line 249):
    Lines: 32
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  _check_capacity (line 282):
    Lines: 44
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 2
    Returns: 3
    Nesting Depth: 1
  __init__ (line 109):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0

File: src/check_zpools/zfs_parser.py
--------------------------------------------------------------------------------
Total Lines: 703
Code Lines: 548
Functions: 15
Classes: 2
Avg Complexity: 3.40
Max Complexity: 7

Functions:
  _extract_error_counts (line 433):
    Lines: 49
    Cyclomatic Complexity: 7
    Cognitive Complexity: 12
    Parameters: 2
    Returns: 3
    Nesting Depth: 2
  parse_pool_list (line 86):
    Lines: 55
    Cyclomatic Complexity: 5
    Cognitive Complexity: 5
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  parse_pool_status (line 142):
    Lines: 48
    Cyclomatic Complexity: 5
    Cognitive Complexity: 5
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  merge_pool_data (line 191):
    Lines: 63
    Cyclomatic Complexity: 5
    Cognitive Complexity: 6
    Parameters: 3
    Returns: 1
    Nesting Depth: 2
  _try_parse_datetime_string (line 510):
    Lines: 27
    Cyclomatic Complexity: 5
    Cognitive Complexity: 6
    Parameters: 3
    Returns: 2
    Nesting Depth: 2
  _parse_size_to_bytes (line 361):
    Lines: 71
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  _try_parse_unix_timestamp (line 483):
    Lines: 26
    Cyclomatic Complexity: 4
    Cognitive Complexity: 6
    Parameters: 3
    Returns: 2
    Nesting Depth: 2
  _parse_scrub_time (line 555):
    Lines: 37
    Cyclomatic Complexity: 4
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 4
    Nesting Depth: 1
  _get_property_value (line 336):
    Lines: 23
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 4
    Returns: 2
    Nesting Depth: 1
  _normalize_timezone (line 538):
    Lines: 16
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  _parse_health_state (line 594):
    Lines: 27
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 2
    Nesting Depth: 0
  _extract_capacity_metrics (line 622):
    Lines: 40
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  _extract_scrub_info (line 663):
    Lines: 34
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  _parse_pool_from_list (line 255):
    Lines: 39
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  _parse_pool_from_status (line 295):
    Lines: 40
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0

File: scripts/release.py
--------------------------------------------------------------------------------
Total Lines: 91
Code Lines: 60
Functions: 3
Classes: 0
Avg Complexity: 3.00
Max Complexity: 6

Functions:
  release (line 31):
    Lines: 45
    Cyclomatic Complexity: 6
    Cognitive Complexity: 5
    Parameters: 1
    Returns: 0
    Nesting Depth: 2
  _ensure_clean (line 78):
    Lines: 3
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 0
    Nesting Depth: 1
  _looks_like_semver (line 83):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0

File: scripts/run_cli.py
--------------------------------------------------------------------------------
Total Lines: 155
Code Lines: 120
Functions: 9
Classes: 0
Avg Complexity: 3.44
Max Complexity: 6

Functions:
  invoke_callable (line 74):
    Lines: 16
    Cyclomatic Complexity: 6
    Cognitive Complexity: 6
    Parameters: 3
    Returns: 3
    Nesting Depth: 1
  candid_callable (line 92):
    Lines: 17
    Cyclomatic Complexity: 5
    Cognitive Complexity: 6
    Parameters: 0
    Returns: 3
    Nesting Depth: 2
  load_module (line 19):
    Lines: 14
    Cyclomatic Complexity: 4
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  exit_code_from (line 47):
    Lines: 11
    Cyclomatic Complexity: 4
    Cognitive Complexity: 4
    Parameters: 1
    Returns: 4
    Nesting Depth: 1
  delegate_to_module_entry (line 121):
    Lines: 16
    Cyclomatic Complexity: 4
    Cognitive Complexity: 4
    Parameters: 2
    Returns: 3
    Nesting Depth: 1
  run_cli (line 139):
    Lines: 12
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 3
    Nesting Depth: 1
  temporary_argv (line 36):
    Lines: 9
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  run_python_module (line 111):
    Lines: 8
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  invocation_variants (line 60):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0

File: scripts/clean.py
--------------------------------------------------------------------------------
Total Lines: 49
Code Lines: 39
Functions: 1
Classes: 0
Avg Complexity: 5.00
Max Complexity: 5

Functions:
  clean (line 31):
    Lines: 12
    Cyclomatic Complexity: 5
    Cognitive Complexity: 10
    Parameters: 1
    Returns: 0
    Nesting Depth: 3

File: tests/test_metadata.py
--------------------------------------------------------------------------------
Total Lines: 102
Code Lines: 75
Functions: 6
Classes: 0
Avg Complexity: 2.67
Max Complexity: 5

Functions:
  _resolve_init_conf_path (line 22):
    Lines: 19
    Cyclomatic Complexity: 5
    Cognitive Complexity: 7
    Parameters: 1
    Returns: 2
    Nesting Depth: 3
  _load_init_conf_metadata (line 43):
    Lines: 15
    Cyclomatic Complexity: 5
    Cognitive Complexity: 7
    Parameters: 1
    Returns: 1
    Nesting Depth: 3
  _load_pyproject (line 17):
    Lines: 3
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  test_when_print_info_runs_it_lists_every_field (line 65):
    Lines: 14
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _load_init_conf_module (line 60):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  test_the_metadata_constants_match_the_project (line 82):
    Lines: 20
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0

File: scripts/cli.py
--------------------------------------------------------------------------------
Total Lines: 214
Code Lines: 155
Functions: 22
Classes: 0
Avg Complexity: 1.36
Max Complexity: 4

Functions:
  choose_token (line 41):
    Lines: 19
    Cyclomatic Complexity: 4
    Cognitive Complexity: 5
    Parameters: 5
    Returns: 2
    Nesting Depth: 2
  env_token (line 31):
    Lines: 8
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  remote_choice (line 86):
    Lines: 4
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  bump_command (line 181):
    Lines: 9
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  coverage_choice (line 62):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  part_choice (line 74):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  main (line 96):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  help_command (line 101):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  install_command (line 107):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  dev_command (line 113):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  clean_command (line 119):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  run_command (line 126):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_command (line 134):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  coverage_command (line 145):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  build_command (line 150):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  release_command (line 156):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  push_command (line 164):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  version_command (line 172):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  bump_major_command (line 193):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  bump_minor_command (line 198):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  bump_patch_command (line 203):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  menu_command (line 208):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0

File: tests/test_cli_errors.py
--------------------------------------------------------------------------------
Total Lines: 238
Code Lines: 165
Functions: 14
Classes: 7
Avg Complexity: 2.43
Max Complexity: 4

Functions:
  test_handler_logs_exception_type_name (line 125):
    Lines: 11
    Cyclomatic Complexity: 4
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_handler_logs_error_message_with_details (line 47):
    Lines: 11
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_handler_uses_default_operation_name_when_not_provided (line 60):
    Lines: 10
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_handler_logs_error_with_full_traceback (line 112):
    Lines: 11
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_handler_uses_default_operation_name_when_not_provided (line 138):
    Lines: 10
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_handler_exits_with_code_one (line 32):
    Lines: 9
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_handler_displays_error_message_to_stderr (line 76):
    Lines: 10
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_handler_exits_with_code_one (line 97):
    Lines: 9
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_handler_displays_error_message_to_stderr (line 154):
    Lines: 10
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_value_error_exits_with_code_one (line 170):
    Lines: 12
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_key_error_exits_with_code_one (line 184):
    Lines: 12
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_file_not_found_error_exits_with_code_one (line 198):
    Lines: 12
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_permission_error_exits_with_code_one (line 212):
    Lines: 12
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_runtime_error_exits_with_code_one (line 226):
    Lines: 12
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0

File: tests/test_scripts.py
--------------------------------------------------------------------------------
Total Lines: 267
Code Lines: 213
Functions: 17
Classes: 3
Avg Complexity: 1.47
Max Complexity: 4

Functions:
  test_test_script_uses_pyproject_configuration (line 239):
    Lines: 28
    Cyclomatic Complexity: 4
    Cognitive Complexity: 5
    Parameters: 1
    Returns: 2
    Nesting Depth: 2
  _commands_as_text (line 105):
    Lines: 24
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 1
    Returns: 1
    Nesting Depth: 2
  fake_import (line 219):
    Lines: 7
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  test_run_cli_imports_dynamic_package (line 212):
    Lines: 24
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 3
    Nesting Depth: 1
  __call__ (line 52):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 7
    Returns: 0
    Nesting Depth: 0
  _run (line 79):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 6
    Returns: 1
    Nesting Depth: 0
  _remember_runs (line 64):
    Lines: 39
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 2
    Nesting Depth: 0
  _first_command (line 131):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _sync (line 150):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  _capture_sync (line 149):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  test_get_project_metadata_fields (line 157):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_build_script_uses_metadata (line 171):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_dev_script_installs_dev_extras (line 184):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_install_script_installs_package (line 198):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  _run_cli_main (line 216):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _noop (line 242):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  _always_false (line 245):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0

File: scripts/bump.py
--------------------------------------------------------------------------------
Total Lines: 33
Code Lines: 23
Functions: 1
Classes: 0
Avg Complexity: 3.00
Max Complexity: 3

Functions:
  bump (line 11):
    Lines: 16
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 4
    Returns: 0
    Nesting Depth: 1

File: scripts/bump_version.py
--------------------------------------------------------------------------------
Total Lines: 81
Code Lines: 65
Functions: 5
Classes: 0
Avg Complexity: 2.20
Max Complexity: 3

Functions:
  bump_semver (line 24):
    Lines: 9
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 2
    Returns: 1
    Nesting Depth: 2
  main (line 60):
    Lines: 17
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 0
    Returns: 1
    Nesting Depth: 2
  _write_new_version (line 35):
    Lines: 10
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 1
    Nesting Depth: 1
  _update_changelog (line 47):
    Lines: 11
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  parse_args (line 9):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0

File: scripts/help.py
--------------------------------------------------------------------------------
Total Lines: 42
Code Lines: 25
Functions: 3
Classes: 0
Avg Complexity: 1.67
Max Complexity: 3

Functions:
  render_help (line 13):
    Lines: 9
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 2
    Nesting Depth: 1
  print_help (line 24):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  _default_stream (line 32):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/models.py
--------------------------------------------------------------------------------
Total Lines: 486
Code Lines: 412
Functions: 13
Classes: 5
Avg Complexity: 1.46
Max Complexity: 3

Functions:
  has_errors (line 303):
    Lines: 18
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  __lt__ (line 168):
    Lines: 16
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  __le__ (line 185):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  __gt__ (line 191):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  __ge__ (line 197):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 2
    Nesting Depth: 1
  is_healthy (line 78):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  is_critical (line 101):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _order_value (line 151):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  is_critical (line 204):
    Lines: 25
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  __str__ (line 363):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  has_issues (line 424):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  critical_issues (line 440):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  warning_issues (line 460):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/zfs_client.py
--------------------------------------------------------------------------------
Total Lines: 462
Code Lines: 382
Functions: 9
Classes: 3
Avg Complexity: 2.11
Max Complexity: 3

Functions:
  __init__ (line 109):
    Lines: 28
    Cyclomatic Complexity: 3
    Cognitive Complexity: 3
    Parameters: 3
    Returns: 0
    Nesting Depth: 2
  get_pool_list (line 157):
    Lines: 52
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 4
    Returns: 1
    Nesting Depth: 1
  _execute_command (line 302):
    Lines: 76
    Cyclomatic Complexity: 3
    Cognitive Complexity: 2
    Parameters: 3
    Returns: 1
    Nesting Depth: 1
  check_zpool_available (line 138):
    Lines: 18
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  get_pool_status (line 210):
    Lines: 46
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 1
    Nesting Depth: 1
  get_pool_status_text (line 257):
    Lines: 44
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 1
    Nesting Depth: 1
  _execute_json_command (line 379):
    Lines: 46
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  __init__ (line 58):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  _execute_text_command (line 426):
    Lines: 29
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0

File: tests/test_alerting.py
--------------------------------------------------------------------------------
Total Lines: 380
Code Lines: 270
Functions: 28
Classes: 2
Avg Complexity: 1.14
Max Complexity: 3

Functions:
  test_email_includes_version (line 326):
    Lines: 12
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  test_email_includes_hostname (line 319):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  test_pool_with_scrub_in_progress (line 339):
    Lines: 20
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  email_config (line 38):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  alert_config (line 50):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  alerter (line 61):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  test_alerter_stores_email_config (line 73):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_alerter_applies_custom_subject_prefix (line 80):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_alerter_stores_alert_recipients (line 87):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_alerter_uses_default_subject_prefix_when_not_configured (line 94):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_format_subject_includes_severity_and_pool (line 106):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_format_subject_for_critical_issue (line 124):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_format_body_includes_pool_details (line 131):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  test_format_body_includes_issue_details (line 142):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  test_format_body_includes_recommended_actions_for_capacity (line 149):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_format_body_includes_recommended_actions_for_errors (line 164):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_format_body_includes_recommended_actions_for_scrub (line 179):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_format_body_includes_recommended_actions_for_health (line 193):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_send_alert_calls_smtp (line 209):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_send_alert_handles_smtp_failure (line 232):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_send_alert_returns_false_with_no_recipients (line 246):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  test_format_recovery_subject (line 254):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_format_recovery_body (line 272):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_recovery_calls_smtp (line 281):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_send_recovery_respects_config_flag (line 294):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_recovery_handles_smtp_failure (line 303):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_send_recovery_returns_false_with_no_recipients (line 311):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_pool_never_scrubbed (line 360):
    Lines: 20
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0

File: tests/test_cli.py
--------------------------------------------------------------------------------
Total Lines: 1018
Code Lines: 765
Functions: 70
Classes: 6
Avg Complexity: 1.29
Max Complexity: 3

Functions:
  test_when_send_email_is_invoked_with_valid_config_it_sends (line 700):
    Lines: 38
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_when_send_email_receives_multiple_recipients_it_accepts_them (line 741):
    Lines: 33
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_send_email_includes_html_body_it_sends (line 777):
    Lines: 33
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_send_email_has_attachments_it_sends (line 813):
    Lines: 38
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_when_send_email_smtp_fails_it_reports_error (line 854):
    Lines: 34
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_send_notification_is_invoked_with_valid_config_it_sends (line 913):
    Lines: 32
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_send_notification_receives_multiple_recipients_it_accepts_them (line 948):
    Lines: 33
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_send_notification_smtp_fails_it_reports_error (line 984):
    Lines: 34
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  fake_run_cli (line 183):
    Lines: 14
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 5
    Returns: 1
    Nesting Depth: 1
  test_when_main_receives_no_arguments_cli_main_is_exercised (line 170):
    Lines: 35
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 1
  test_when_config_is_invoked_with_section_showing_complex_values (line 446):
    Lines: 53
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 3
    Nesting Depth: 0
  test_when_config_deploy_is_invoked_without_target_it_fails (line 557):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  _run (line 59):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 1
    Nesting Depth: 0
  _capture_run_cli (line 43):
    Lines: 36
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 2
    Nesting Depth: 0
  test_when_we_snapshot_traceback_the_initial_state_is_quiet (line 82):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_we_enable_traceback_the_config_sings_true (line 87):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_we_restore_traceback_the_config_whispers_false (line 95):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  record (line 113):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_when_info_runs_with_traceback_the_choice_is_shared (line 106):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_when_main_is_called_it_delegates_to_run_cli (line 132):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  remember (line 157):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_when_cli_runs_without_arguments_help_is_printed (line 151):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  remember (line 178):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  remember (line 214):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_when_traceback_is_requested_without_command_the_domain_runs (line 208):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_when_traceback_flag_is_passed_the_full_story_is_printed (line 227):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_when_hello_is_invoked_the_cli_smiles (line 245):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_fail_is_invoked_the_cli_raises (line 253):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_info_is_invoked_the_metadata_is_displayed (line 261):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_config_is_invoked_it_displays_configuration (line 270):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_config_is_invoked_with_json_format_it_outputs_json (line 278):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_config_is_invoked_with_nonexistent_section_it_fails (line 287):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  __init__ (line 311):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  as_dict (line 317):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  to_json (line 320):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  get (line 325):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  origin (line 328):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  mock_get_config (line 339):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  test_when_config_is_invoked_with_mocked_data_it_displays_sections (line 295):
    Lines: 57
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 5
    Nesting Depth: 0
  __init__ (line 371):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  get (line 376):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  origin (line 379):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  mock_get_config (line 387):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  test_when_config_is_invoked_with_json_format_and_section_it_shows_section (line 355):
    Lines: 44
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 3
    Nesting Depth: 0
  __init__ (line 417):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  get (line 422):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  origin (line 425):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  mock_get_config (line 433):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  test_when_config_is_invoked_with_json_format_and_nonexistent_section_it_fails (line 402):
    Lines: 41
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 3
    Nesting Depth: 0
  __init__ (line 464):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  get (line 469):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  origin (line 472):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  mock_get_config (line 480):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  __init__ (line 522):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  as_dict (line 527):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  origin (line 530):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  mock_get_config (line 538):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  test_when_config_shows_all_sections_with_complex_values (line 502):
    Lines: 52
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 3
    Nesting Depth: 0
  mock_deploy (line 576):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  test_when_config_deploy_is_invoked_it_deploys_configuration (line 565):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  mock_deploy (line 596):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  test_when_config_deploy_finds_no_files_to_create_it_informs_user (line 590):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  mock_deploy (line 613):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_when_config_deploy_encounters_permission_error_it_handles_gracefully (line 609):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  mock_deploy (line 638):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  test_when_config_deploy_supports_multiple_targets (line 626):
    Lines: 25
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 1
    Nesting Depth: 0
  test_when_an_unknown_command_is_used_a_helpful_error_appears (line 654):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_restore_is_disabled_the_traceback_choice_remains (line 662):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_when_send_email_is_invoked_without_smtp_hosts_it_fails (line 678):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_send_notification_is_invoked_without_smtp_hosts_it_fails (line 891):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0

File: tests/test_formatters.py
--------------------------------------------------------------------------------
Total Lines: 1214
Code Lines: 851
Functions: 78
Classes: 21
Avg Complexity: 1.05
Max Complexity: 3

Functions:
  test_naive_datetime_is_treated_as_utc (line 1041):
    Lines: 14
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_table_includes_error_column (line 794):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_can_call_without_console_parameter (line 887):
    Lines: 14
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  a_warning_issue_for (line 43):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  a_critical_issue_for (line 54):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  an_info_issue_for (line 65):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  an_issue_with (line 76):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 1
    Nesting Depth: 0
  a_check_result_with_no_issues (line 87):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  a_check_result_with_warning (line 97):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  a_check_result_with_critical (line 107):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  test_ok_result_produces_valid_json (line 126):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_includes_timestamp (line 137):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_includes_overall_severity (line 148):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_includes_pool_details (line 159):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_includes_empty_issues_list (line 173):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_result_includes_warning_severity (line 188):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_result_includes_issue_details (line 199):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_result_includes_issue_detail_fields (line 215):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_critical_result_includes_critical_severity (line 231):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_critical_result_includes_health_category (line 242):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_multiple_pools_appear_in_json_array (line 259):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_multiple_issues_appear_in_json_array (line 280):
    Lines: 20
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_json_output_is_pretty_printed_with_newlines (line 306):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_json_output_uses_two_space_indentation (line 316):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_includes_header (line 335):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_includes_formatted_timestamp (line 345):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_shows_overall_status (line 355):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_shows_no_issues_message (line 365):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_result_shows_pool_count (line 375):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_result_shows_warning_status (line 389):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_result_shows_issues_found_section (line 399):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_severity_appears_in_yellow (line 409):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_result_includes_issue_message (line 419):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_critical_result_shows_critical_status (line 433):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_critical_severity_appears_in_red (line 443):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_critical_result_includes_issue_message (line 453):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_info_severity_appears_in_green (line 467):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_info_result_includes_message (line 485):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_multiple_issues_all_appear_in_output (line 507):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_multiple_issues_show_different_colors (line 527):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_ok_severity_maps_to_exit_code_zero (line 556):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_info_severity_maps_to_exit_code_zero (line 564):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_severity_maps_to_exit_code_one (line 576):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_critical_severity_maps_to_exit_code_two (line 588):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_includes_header_and_timestamp (line 605):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_shows_overall_status (line 619):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_shows_pool_status_table (line 632):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_shows_no_issues_message (line 646):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_shows_pools_checked_count (line 659):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_shows_issues_found_section (line 676):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_shows_warning_issue_message (line 689):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_shows_critical_issue_message (line 703):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_display_shows_multiple_issues (line 717):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_table_includes_health_column (line 745):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_table_includes_capacity_column (line 759):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_table_includes_size_column_with_human_readable_format (line 774):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_table_shows_pool_with_errors (line 809):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_table_shows_all_pools (line 838):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_pools_checked_count_matches_pool_count (line 861):
    Lines: 20
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_none_returns_never_yellow (line 912):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_today_returns_green (line 921):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_yesterday_returns_green (line 933):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_three_days_ago_returns_green (line 945):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_six_days_ago_returns_green (line 957):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_two_weeks_ago_returns_green (line 969):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_29_days_ago_returns_green (line 981):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_45_days_ago_returns_yellow (line 993):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_59_days_ago_returns_yellow (line 1005):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_90_days_ago_returns_red (line 1017):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_180_days_ago_returns_red (line 1029):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_timezone_aware_datetime_converted_to_utc (line 1057):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_boundary_7_days_shows_weeks (line 1071):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_boundary_30_days_shows_days_not_months (line 1083):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_boundary_60_days_shows_months (line 1095):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_severity_color_caching_produces_cache_hits (line 1116):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_severity_color_caching_covers_all_enum_values (line 1140):
    Lines: 24
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_exit_code_caching_produces_cache_hits (line 1170):
    Lines: 20
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_exit_code_caching_covers_all_enum_values (line 1192):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0

File: tests/test_mail.py
--------------------------------------------------------------------------------
Total Lines: 574
Code Lines: 448
Functions: 39
Classes: 7
Avg Complexity: 1.49
Max Complexity: 3

Functions:
  test_send_email_missing_attachment_raises (line 413):
    Lines: 19
    Cyclomatic Complexity: 3
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  smtp_config (line 516):
    Lines: 15
    Cyclomatic Complexity: 3
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  test_validation_negative_timeout_raises (line 45):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validation_zero_timeout_raises (line 50):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validation_invalid_from_address_raises (line 55):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validation_invalid_smtp_host_port_format (line 60):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validation_invalid_port_number (line 65):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validation_port_out_of_range_high (line 70):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validation_port_out_of_range_low (line 75):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_frozen_dataclass (line 108):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_send_email_smtp_connection_failure (line 352):
    Lines: 17
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_email_authentication_failure (line 371):
    Lines: 21
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_email_invalid_recipients (line 394):
    Lines: 18
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_email_all_smtp_hosts_fail (line 434):
    Lines: 16
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_real_email (line 532):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  test_send_real_email_with_html (line 546):
    Lines: 14
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  test_send_real_notification (line 561):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 2
    Returns: 0
    Nesting Depth: 1
  test_default_values (line 32):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validation_smtp_host_without_port_valid (line 80):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validation_smtp_host_with_valid_port (line 85):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_custom_values (line 90):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_to_conf_mail (line 115):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_empty_config (line 137):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_email_section_loaded (line 144):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_partial_config (line 166):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_invalid_email_section (line 182):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_send_simple_email (line 197):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_email_with_html (line 214):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_email_multiple_recipients (line 232):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_email_with_from_override (line 249):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_email_with_attachments (line 267):
    Lines: 20
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_send_email_with_credentials (line 289):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_simple_notification (line 313):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_send_notification_multiple_recipients (line 330):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_malformed_timeout_uses_default (line 455):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_smtp_hosts_not_list_uses_default (line 463):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_boolean_as_string_uses_default (line 471):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_empty_string_username_becomes_none (line 479):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_mixed_valid_invalid_config (line 489):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0

File: scripts/build.py
--------------------------------------------------------------------------------
Total Lines: 53
Code Lines: 33
Functions: 5
Classes: 0
Avg Complexity: 1.40
Max Complexity: 2

Functions:
  _purge_dist (line 25):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1
  build_artifacts (line 33):
    Lines: 10
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 0
    Nesting Depth: 1
  _status (line 17):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  _failure (line 21):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  main (line 45):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0

File: scripts/target_metadata.py
--------------------------------------------------------------------------------
Total Lines: 175
Code Lines: 150
Functions: 4
Classes: 2
Avg Complexity: 1.50
Max Complexity: 2

Functions:
  _env_default (line 58):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  iter_help_rows (line 169):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 0
    Nesting Depth: 1
  _build_targets (line 65):
    Lines: 96
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  get_targets (line 163):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0

File: scripts/version_current.py
--------------------------------------------------------------------------------
Total Lines: 21
Code Lines: 12
Functions: 1
Classes: 0
Avg Complexity: 2.00
Max Complexity: 2

Functions:
  print_current_version (line 10):
    Lines: 7
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 1
    Returns: 1
    Nesting Depth: 1

File: src/check_zpools/__main__.py
--------------------------------------------------------------------------------
Total Lines: 124
Code Lines: 86
Functions: 4
Classes: 0
Avg Complexity: 1.25
Max Complexity: 2

Functions:
  _module_main (line 96):
    Lines: 24
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  _open_cli_session (line 48):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  _command_to_run (line 68):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  _command_name (line 82):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/logging_setup.py
--------------------------------------------------------------------------------
Total Lines: 130
Code Lines: 86
Functions: 2
Classes: 0
Avg Complexity: 1.50
Max Complexity: 2

Functions:
  init_logging (line 75):
    Lines: 50
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 0
    Nesting Depth: 1
  _build_runtime_config (line 34):
    Lines: 39
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0

File: tests/test_alert_state.py
--------------------------------------------------------------------------------
Total Lines: 632
Code Lines: 428
Functions: 38
Classes: 15
Avg Complexity: 1.16
Max Complexity: 2

Functions:
  test_saved_json_has_version_field (line 414):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_saved_json_includes_alert_states (line 429):
    Lines: 14
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_load_restores_state_from_file (line 449):
    Lines: 27
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_corrupt_json_starts_empty (line 496):
    Lines: 11
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_wrong_version_starts_empty (line 509):
    Lines: 12
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_corrupt_entries_are_skipped_but_valid_loaded (line 523):
    Lines: 29
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  a_capacity_issue_for (line 31):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  an_error_issue_for (line 42):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  a_health_issue_for (line 53):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  an_alert_state (line 64):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 1
    Nesting Depth: 0
  a_state_manager (line 81):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  test_alert_state_remembers_pool_name (line 96):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_alert_state_remembers_issue_category (line 104):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_alert_state_remembers_timestamps (line 112):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_alert_state_remembers_alert_count (line 128):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_manager_creates_parent_directory_if_missing (line 145):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_new_manager_starts_with_empty_state (line 155):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_brand_new_issue_should_alert (line 172):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_immediate_duplicate_is_suppressed (line 187):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_duplicate_after_one_hour_is_suppressed (line 199):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_resend_after_exact_interval_boundary (line 217):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_resend_after_interval_plus_one_hour (line 231):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_short_interval_allows_faster_resends (line 245):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_recording_creates_state_entry (line 268):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_recorded_state_has_correct_pool_name (line 279):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_recorded_state_has_correct_category (line 291):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_new_alert_starts_with_count_one (line 303):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_second_alert_increments_count_to_two (line 319):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_third_alert_increments_count_to_three (line 332):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_clearing_removes_state_entry (line 355):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_clearing_returns_true_when_found (line 367):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_clearing_nonexistent_returns_false (line 383):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_save_creates_json_file (line 402):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_missing_file_starts_empty (line 482):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_state_survives_manager_recreation (line 563):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_different_categories_on_same_pool_tracked_separately (line 589):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_same_category_on_different_pools_tracked_separately (line 604):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_three_different_issues_all_tracked (line 619):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0

File: tests/test_behaviors.py
--------------------------------------------------------------------------------
Total Lines: 365
Code Lines: 270
Functions: 29
Classes: 4
Avg Complexity: 1.48
Max Complexity: 2

Functions:
  test_when_failure_is_invoked_a_runtime_error_rises (line 58):
    Lines: 3
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_validate_warning_below_zero (line 124):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_warning_zero (line 131):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_warning_above_100 (line 138):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_critical_zero (line 145):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_critical_above_100 (line 152):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_warning_greater_than_critical (line 159):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_warning_equal_to_critical (line 173):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_scrub_age_negative (line 187):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_read_errors_negative (line 194):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_write_errors_negative (line 201):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_validate_checksum_errors_negative (line 208):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_check_pools_once_with_custom_config (line 306):
    Lines: 20
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_check_pools_once_handles_zfs_not_available (line 328):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_when_the_greeting_is_sung_it_reaches_the_buffer (line 18):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_when_no_stream_is_named_stdout_hears_the_song (line 27):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  write (line 43):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  flush (line 46):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_when_flush_is_possible_the_stream_is_polished (line 37):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_when_no_work_is_requested_the_placeholder_sits_still (line 64):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_build_with_defaults (line 72):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_build_with_custom_capacity (line 82):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_build_with_custom_scrub (line 98):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_build_with_custom_errors (line 106):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_allow_scrub_age_zero (line 215):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_allow_critical_100_percent (line 223):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_check_pools_once_success (line 247):
    Lines: 56
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_get_state_file_path_with_custom_path (line 347):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_get_state_file_path_with_default (line 356):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0

File: tests/test_daemon.py
--------------------------------------------------------------------------------
Total Lines: 774
Code Lines: 622
Functions: 42
Classes: 7
Avg Complexity: 1.02
Max Complexity: 2

Functions:
  failing_then_succeeding_get_pool_list (line 753):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 0
    Returns: 1
    Nesting Depth: 1
  a_healthy_pool_for_daemon (line 32):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  a_capacity_issue_for_daemon (line 50):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  an_ok_check_result (line 61):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  healthy_pool_json (line 77):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  degraded_pool_json (line 103):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  pool_list_json (line 129):
    Lines: 27
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  mock_zfs_client (line 159):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0
  mock_monitor (line 169):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  mock_alerter (line 182):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  mock_state_manager (line 191):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  daemon_config (line 199):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  daemon (line 210):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 1
    Nesting Depth: 0
  test_daemon_remembers_all_provided_components (line 231):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 6
    Returns: 0
    Nesting Depth: 0
  test_daemon_applies_configured_check_interval (line 254):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 6
    Returns: 0
    Nesting Depth: 0
  test_daemon_uses_five_minute_default_when_interval_not_specified (line 274):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_check_cycle_fetches_pool_list_from_zfs (line 298):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_check_cycle_fetches_pool_status_from_zfs (line 305):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_check_cycle_passes_parsed_pools_to_monitor (line 312):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_check_cycle_monitors_specific_pool_by_name (line 322):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_check_cycle_recovers_from_zfs_fetch_errors (line 330):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_check_cycle_recovers_from_parse_errors (line 338):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_new_issue_triggers_email_alert (line 351):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_new_issue_alert_includes_issue_details (line 375):
    Lines: 24
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_new_issue_alert_includes_pool_status (line 400):
    Lines: 24
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_new_issue_updates_state_manager (line 425):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_duplicate_issue_alert_is_suppressed (line 449):
    Lines: 23
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_ok_severity_issues_do_not_trigger_alerts (line 473):
    Lines: 27
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  test_resolved_issue_triggers_recovery_notification (line 506):
    Lines: 32
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_recovery_notification_includes_pool_name (line 539):
    Lines: 31
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_recovery_notification_includes_issue_category (line 571):
    Lines: 31
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_recovery_notification_includes_pool_status (line 603):
    Lines: 31
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_recovery_clears_issue_from_state_manager (line 635):
    Lines: 30
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 5
    Returns: 0
    Nesting Depth: 0
  test_setup_registers_sigterm_handler (line 671):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_setup_registers_sigint_handler (line 681):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_stop_sets_shutdown_event (line 696):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_stop_sets_running_flag_to_false (line 705):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_stop_is_idempotent (line 714):
    Lines: 9
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  run_loop (line 733):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_loop_executes_at_least_one_check_cycle (line 729):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  run_loop (line 762):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0
  test_loop_continues_after_transient_errors (line 748):
    Lines: 26
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 1
    Nesting Depth: 0

File: tests/test_models.py
--------------------------------------------------------------------------------
Total Lines: 579
Code Lines: 423
Functions: 42
Classes: 17
Avg Complexity: 1.14
Max Complexity: 2

Functions:
  test_invalid_health_state_raises_value_error (line 56):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_pool_name_cannot_be_changed_after_creation (line 183):
    Lines: 7
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_pool_health_cannot_be_modified (line 192):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_issue_pool_name_cannot_be_changed (line 271):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_issue_severity_cannot_be_modified (line 279):
    Lines: 6
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_overall_severity_cannot_be_changed (line 341):
    Lines: 11
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_all_six_zfs_health_states_exist (line 36):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_health_states_can_be_constructed_from_strings (line 48):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_only_online_is_considered_healthy (line 67):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_faulted_unavail_and_removed_are_critical (line 77):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_online_degraded_and_offline_are_not_critical (line 84):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_all_four_severity_levels_exist (line 100):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_severities_have_natural_ordering (line 109):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_max_returns_highest_severity (line 117):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_max_of_non_critical_severities_returns_highest (line 124):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_severities_support_equality_comparison (line 130):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_status_remembers_all_its_attributes (line 145):
    Lines: 32
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_read_errors_knows_it_has_problems (line 204):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_write_errors_knows_it_has_problems (line 211):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_checksum_errors_knows_it_has_problems (line 218):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_multiple_error_types_reports_errors (line 225):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_zero_errors_is_error_free (line 232):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_an_issue_remembers_its_pool_and_severity (line 248):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_issue_string_contains_severity_pool_and_message (line 291):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_critical_issue_string_shows_critical_severity (line 299):
    Lines: 7
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_check_result_remembers_timestamp_pools_and_issues (line 317):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_check_result_with_no_issues_reports_none (line 358):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_check_result_with_any_issue_reports_it (line 370):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_critical_issues_returns_only_critical_severity (line 387):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_issues_returns_only_warning_severity (line 407):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_filtering_with_no_matching_issues_returns_empty_list (line 427):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_check_result_preserves_order_of_multiple_pools (line 446):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_pool_with_zero_capacity_is_valid (line 475):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_pool_with_full_capacity_is_valid (line 487):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_pool_with_no_last_scrub_is_valid (line 499):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_pool_with_scrub_in_progress_is_valid (line 506):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_pool_with_large_error_counts_is_valid (line 513):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_severity_ok_is_minimum (line 531):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_severity_critical_is_maximum (line 538):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_max_of_single_severity_returns_that_severity (line 545):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_check_result_with_empty_pools_list_is_valid (line 554):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_check_result_with_many_issues_preserves_all (line 566):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0

File: tests/test_module_entry.py
--------------------------------------------------------------------------------
Total Lines: 165
Code Lines: 126
Functions: 10
Classes: 1
Avg Complexity: 1.40
Max Complexity: 2

Functions:
  test_when_module_entry_returns_zero_the_story_matches_cli (line 72):
    Lines: 26
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  exploding_run_cli (line 112):
    Lines: 10
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 2
    Nesting Depth: 0
  test_when_module_entry_raises_the_exit_helpers_format_the_song (line 101):
    Lines: 36
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 3
    Nesting Depth: 0
  test_when_traceback_flag_is_used_via_module_entry_the_full_poem_is_printed (line 140):
    Lines: 20
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  _printer (line 54):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  _record_print_message (line 37):
    Lines: 32
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  fake_run_cli (line 77):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 1
    Nesting Depth: 0
  fake_code (line 108):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  default_handler (line 117):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  test_when_module_entry_imports_cli_the_alias_stays_intact (line 163):
    Lines: 2
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0

File: tests/test_monitor.py
--------------------------------------------------------------------------------
Total Lines: 711
Code Lines: 512
Functions: 45
Classes: 15
Avg Complexity: 1.09
Max Complexity: 2

Functions:
  test_warning_greater_than_critical_is_rejected (line 162):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_warning_equal_to_critical_is_rejected (line 169):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_negative_capacity_percentage_is_rejected (line 176):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_percentage_above_hundred_is_rejected (line 183):
    Lines: 5
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  a_healthy_pool_named (line 28):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  a_pool_with (line 49):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  a_monitor_with_default_thresholds (line 73):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  a_monitor_with_strict_thresholds (line 78):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  test_default_capacity_warning_is_eighty_percent (line 100):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_default_capacity_critical_is_ninety_percent (line 108):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_default_scrub_max_age_is_thirty_days (line 116):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_default_error_thresholds_are_one (line 124):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_custom_capacity_thresholds_are_preserved (line 138):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_custom_scrub_age_is_preserved (line 150):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_an_online_pool_generates_no_health_issues (line 199):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_degraded_pool_triggers_warning (line 211):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_faulted_pool_triggers_critical (line 225):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_an_unavailable_pool_triggers_critical (line 239):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_seventy_nine_percent_is_ok (line 261):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_fifty_percent_is_ok (line 273):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_exactly_eighty_percent_triggers_warning (line 289):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_eighty_one_percent_triggers_warning (line 303):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_eighty_five_percent_triggers_warning (line 320):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_exactly_ninety_percent_triggers_critical (line 337):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_ninety_five_percent_triggers_critical (line 351):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_full_one_hundred_percent_triggers_critical (line 364):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_no_errors_generates_no_error_issues (line 386):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_read_errors_triggers_warning (line 398):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_write_errors_triggers_warning (line 412):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_checksum_errors_triggers_warning (line 426):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_all_error_types_generates_three_issues (line 441):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_recently_scrubbed_pool_generates_no_scrub_issues (line 462):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_never_scrubbed_pool_triggers_info (line 477):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_old_scrub_triggers_info (line 491):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_scrub_errors_triggers_warning (line 505):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_scrub_age_checking_can_be_disabled (line 522):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_monitoring_multiple_pools_aggregates_all_results (line 544):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_overall_severity_is_maximum_of_all_issues (line 563):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_all_healthy_pools_result_in_ok_severity (line 583):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_zero_percent_generates_no_issues (line 607):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_capacity_at_89_point_9_percent_triggers_warning_not_critical (line 619):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_scrub_exactly_at_max_age_boundary_triggers_info (line 636):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_scrub_at_29_days_generates_no_issues (line 649):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_strict_capacity_thresholds_trigger_earlier (line 668):
    Lines: 17
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0
  test_a_pool_with_multiple_problems_generates_multiple_issues (line 691):
    Lines: 20
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0

File: tests/test_zfs_parser.py
--------------------------------------------------------------------------------
Total Lines: 768
Code Lines: 582
Functions: 43
Classes: 7
Avg Complexity: 1.19
Max Complexity: 2

Functions:
  zpool_list_ok (line 36):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  zpool_status_degraded (line 43):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  zpool_status_with_errors (line 50):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0
  test_parse_multiple_pools (line 86):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 1
    Parameters: 3
    Returns: 0
    Nesting Depth: 1
  test_parse_pool_list_fatal_error (line 378):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_pool_status_fatal_error (line 392):
    Lines: 13
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_size_with_invalid_number_and_valid_suffix (line 551):
    Lines: 15
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_size_invalid_format (line 664):
    Lines: 4
    Cyclomatic Complexity: 2
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  parser (line 24):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  sample_data_dir (line 30):
    Lines: 3
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  test_parse_empty_pools (line 59):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_missing_pools_key (line 65):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_single_healthy_pool (line 71):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_parse_pool_with_missing_properties (line 100):
    Lines: 19
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_degraded_pool (line 125):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_parse_pool_with_errors (line 138):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_parse_scrub_information (line 151):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_parse_scrub_errors (line 162):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_parse_pool_with_unknown_health (line 169):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_merge_combines_capacity_and_errors (line 190):
    Lines: 55
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_merge_handles_pool_only_in_list (line 246):
    Lines: 26
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_merge_handles_pool_only_in_status (line 273):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_pool_list_with_malformed_individual_pool (line 300):
    Lines: 43
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_pool_status_with_malformed_individual_pool (line 344):
    Lines: 33
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_extract_capacity_metrics_with_invalid_capacity (line 406):
    Lines: 28
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_extract_scrub_info_with_invalid_scrub_errors (line 435):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_extract_errors_newer_vdev_format (line 461):
    Lines: 22
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_extract_errors_with_non_numeric_error_values (line 484):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_scrub_time_with_human_readable_datetime (line 506):
    Lines: 21
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_normalize_timezone_with_naive_datetime (line 528):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_get_property_value_with_non_dict_property (line 567):
    Lines: 12
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_get_property_value_with_dict (line 584):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_get_property_value_missing_key (line 590):
    Lines: 5
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_size_to_bytes_numeric (line 596):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_size_with_suffix (line 645):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 4
    Returns: 0
    Nesting Depth: 0
  test_parse_size_caching (line 669):
    Lines: 14
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_extract_error_counts_from_vdev_tree (line 684):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_extract_error_counts_missing_stats (line 701):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_scrub_time_with_valid_timestamp (line 710):
    Lines: 8
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_scrub_time_with_no_end_time (line 719):
    Lines: 6
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_scrub_time_with_empty_scan_info (line 726):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_health_state_caching (line 731):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  test_parse_health_state_caching_with_multiple_states (line 750):
    Lines: 18
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0

File: scripts/bump_major.py
--------------------------------------------------------------------------------
Total Lines: 21
Code Lines: 11
Functions: 1
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  bump_major (line 11):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0

File: scripts/bump_minor.py
--------------------------------------------------------------------------------
Total Lines: 21
Code Lines: 11
Functions: 1
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  bump_minor (line 11):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0

File: scripts/bump_patch.py
--------------------------------------------------------------------------------
Total Lines: 21
Code Lines: 11
Functions: 1
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  bump_patch (line 11):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0

File: scripts/dev.py
--------------------------------------------------------------------------------
Total Lines: 20
Code Lines: 10
Functions: 1
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  install_dev (line 10):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0

File: scripts/install.py
--------------------------------------------------------------------------------
Total Lines: 20
Code Lines: 10
Functions: 1
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  install (line 10):
    Lines: 4
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 0
    Nesting Depth: 0

File: src/check_zpools/__init__conf__.py
--------------------------------------------------------------------------------
Total Lines: 75
Code Lines: 52
Functions: 1
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  print_info (line 45):
    Lines: 30
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 0
    Nesting Depth: 0

File: src/check_zpools/cli_errors.py
--------------------------------------------------------------------------------
Total Lines: 93
Code Lines: 71
Functions: 2
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  handle_zfs_not_available (line 27):
    Lines: 27
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0
  handle_generic_error (line 56):
    Lines: 31
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 0
    Nesting Depth: 0

File: src/check_zpools/config.py
--------------------------------------------------------------------------------
Total Lines: 129
Code Lines: 94
Functions: 2
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  get_default_config_path (line 34):
    Lines: 24
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 0
    Returns: 1
    Nesting Depth: 0
  get_config (line 67):
    Lines: 56
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 1
    Returns: 1
    Nesting Depth: 0

File: src/check_zpools/config_deploy.py
--------------------------------------------------------------------------------
Total Lines: 113
Code Lines: 90
Functions: 1
Classes: 0
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  deploy_configuration (line 31):
    Lines: 77
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 2
    Returns: 1
    Nesting Depth: 0

File: tests/test_config_deploy.py
--------------------------------------------------------------------------------
Total Lines: 304
Code Lines: 209
Functions: 15
Classes: 7
Avg Complexity: 1.00
Max Complexity: 1

Functions:
  test_deploy_to_user_calls_deploy_config_with_user_target (line 35):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_to_user_returns_deployed_path (line 49):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_to_host_calls_deploy_config_with_host_target (line 68):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_to_host_returns_system_path (line 82):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_to_app_calls_deploy_config_with_app_target (line 100):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_to_app_returns_application_path (line 114):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_to_app_and_user_includes_both_targets (line 137):
    Lines: 15
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_to_multiple_targets_returns_all_paths (line 155):
    Lines: 16
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_without_force_defaults_to_false (line 184):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_with_force_passes_true_to_deploy_config (line 198):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_returns_empty_list_when_files_exist_without_force (line 212):
    Lines: 10
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_passes_vendor_from_package_metadata (line 235):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_passes_app_from_package_metadata (line 251):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_passes_slug_from_package_metadata (line 267):
    Lines: 13
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0
  test_deploy_uses_default_config_path_as_source (line 293):
    Lines: 11
    Cyclomatic Complexity: 1
    Cognitive Complexity: 0
    Parameters: 3
    Returns: 0
    Nesting Depth: 0

File: scripts/__init__.py
--------------------------------------------------------------------------------
Total Lines: 4
Code Lines: 2
Functions: 0
Classes: 0
Avg Complexity: 0.00
Max Complexity: 0


File: scripts/__main__.py
--------------------------------------------------------------------------------
Total Lines: 8
Code Lines: 4
Functions: 0
Classes: 0
Avg Complexity: 0.00
Max Complexity: 0


File: src/check_zpools/__init__.py
--------------------------------------------------------------------------------
Total Lines: 22
Code Lines: 18
Functions: 0
Classes: 0
Avg Complexity: 0.00
Max Complexity: 0

